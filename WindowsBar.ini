[Metadata]
Name = WindowsBar
Author = Meti0X7CB
Information = "A simple Windows Bar"
Version = 1.1
License = GNU General Public License v3.0

[Rainmeter]
Update = 60
AccurateText = 1
DefaultAlwaysOnTop = 0
DefaultDraggable = 0
DefaultAutoSelectScreen = 0
DefaultWindowY = 0
DefaultAnchorY = 0
OnRefreshAction = [!WriteKeyValue Variables Scale "[AppBar:MonitorScale()]" "#@#Variables.inc"][!ActivateConfig "WindowsBar\AudioCore" "Visualizer.ini"]
OnCloseAction = [!DeactivateConfig "WindowsBar\AudioCore" "Visualizer.ini"]

[Variables]
Scale = [AppBar:MonitorScale()]
Color = 222,222,222
Highlight = [WindowsAccentColor]
Height = 35
FrostLevel = Acrylic
Theme = Light4
CornerType = None
PlayerId = "Active"

[MeasureWindowsTheme]
Measure = Registry
RegHKey = HKEY_CURRENT_USER
RegKey = Software\Microsoft\Windows\CurrentVersion\Themes\Personalize
RegValue = AppsUseLightTheme
IfCondition = MeasureWindowsTheme = 1
IfTrueAction = [!SetVariable Theme "Light4"][!SetVariable Color "28,28,28"]
IfFalseAction = [!SetVariable Theme "Dark4"][!SetVariable Color "222,222,222"]
DynamicVariables = 1

[WindowsAccentColor]
Measure = Plugin
Plugin = SysColor
ColorType = Accent

[AppBar]
Measure = Plugin
Plugin = AppBar
PriorityList =
UsePrimaryMonitorByDefault = 0
RequiredSpace = (#Height#)
Edge = Top
DPIAware = 1
WatchOnly = 0
DynamicVariables = 1

[FrostedGlass]
Measure = Plugin
Plugin = FrostedGlass
Type = #FrostLevel#
Border = None
Corner = #CornerType#
Backdrop = #Theme#
BorderVisible = 0
DynamicVariables = 1

[BottonStyle]
Meter = Shape
Shape = Rectangle 0,0,(21*#Scale#),(21*#Scale#),(2.5*#Scale#),(2.5*#Scale#) | Fill Color 255,255,255,30 | StrokeWidth 1 | Stroke Color 255,255,255,30
Hidden = 1
AntiAlias = 1
DynamicVariables = 1

[MeterCanvas]
Meter = Shape
Shape = Rectangle 0,0,(#SCREENAREAWIDTH#),(#Height#*#Scale#),0 | Fill Color 0,0,0,0 | StrokeWidth 0
DynamicVariables = 1

[MeasureStatus]
Measure = Plugin
Plugin = WebNowPlaying
PlayerType = Status
PlayerId = #PlayerId#
IfCondition = MeasureStatus = 1
IfTrueAction = [!ShowMeterGroup "Active"]
IfFalseAction = [!HideMeterGroup "Active"]
DynamicVariables = 1

[MeasureTitle]
Measure = Plugin
Plugin = WebNowPlaying
PlayerType = Title
PlayerId = #PlayerId#
DynamicVariables = 1
Substitute = "0":""
DynamicVariables = 1

[MeterTitle]
Meter = String
MeasureName = MeasureTitle
X = (75*#Scale#)
Y = ((#Height#*#Scale#)-(19.5*#Scale#))/2
FontColor = #Color#
FontSize = (10*#Scale#)
FontFace = Segoe UI
FontWeight = 500
AntiAlias = 1
ClipString = 1
StringAlign = LeftTop
DynamicVariables = 1
Group = Active

[MusicSpacer]
Meter = String
Text = " -"
X = R
Y = ((#Height#*#Scale#)-(19.5*#Scale#))/2
FontColor = #Color#
FontSize = (10*#Scale#)
FontFace = Segoe UI
FontWeight = 500
AntiAlias = 1
ClipString = 1
StringAlign = LeftTop
DynamicVariables = 1
Group = Active

[MeasureArtist]
Measure = Plugin
Plugin = WebNowPlaying
PlayerType = Artist
PlayerId = #PlayerId#
DynamicVariables = 1
Substitute = "0":""

[MeterArtist]
Meter = String
MeasureName = MeasureArtist
Text = " %1"
X = R
Y = ((#Height#*#Scale#)-(19.5*#Scale#))/2
FontColor = #Color#
FontSize = (10*#Scale#)
FontFace = Segoe UI
FontWeight = 500
AntiAlias = 1
ClipString = 1
StringAlign = LeftTop
DynamicVariables = 1
Group = Active

[MeasurePlayPause]
Measure = Plugin
Plugin = WebNowPlaying
PlayerType = State
PlayerId = #PlayerId#
Substitute = "0":"Play","1":"Pause","2":"Play","3":"Replay"
DynamicVariables = 1

[MeterPrev]
Meter = Image
ImageName = #@#Previous.png
X = (10*#Scale#)R
Y = ((#Height#*#Scale#)-(15*#Scale#))/2
W = (15*#Scale#)
H = (15*#Scale#)
AntiAlias = 1
ImageTint = #Color#
LeftMouseDownAction = [!SetOption MeterPrev ImageTint "#Highlight#"]
LeftMouseUpAction = [!SetOption MeterPrev ImageTint "#*Color*#"][!CommandMeasure MeasurePlayPause "Previous"]
MouseOverAction = [!ShowMeter BottonStyle][!SetOption BottonStyle X "([MeterPrev:X]-(2.7*#Scale#))"][!SetOption BottonStyle Y "([MeterPrev:Y]-(2.7*#Scale#))"]
MouseLeaveAction = [!SetOption MeterPrev ImageTint "#*Color*#"][!HideMeter BottonStyle]
DynamicVariables = 1
Group = Active

[MeterPlayPause]
Meter = Image
ImageName = #@#[MeasurePlayPause].png
X = (10*#Scale#)R
Y = ((#Height#*#Scale#)-(16*#Scale#))/2
W = (16*#Scale#)
H = (16*#Scale#)
AntiAlias = 1
ImageTint = #Color#
LeftMouseDownAction = [!SetOption MeterPlayPause ImageTint "#Highlight#"]
LeftMouseUpAction = [!SetOption MeterPlayPause ImageTint "#*Color*#"][!CommandMeasure MeasurePlayPause "PlayPause"][!UpdateMeasure MeasurePlayPause]
MouseOverAction = [!ShowMeter BottonStyle][!SetOption BottonStyle X "([MeterPlayPause:X]-(2.5*#Scale#))"][!SetOption BottonStyle Y "([MeterPlayPause:Y]-(2.5*#Scale#))"]
MouseLeaveAction = [!SetOption MeterPlayPause ImageTint "#*Color*#"][!HideMeter BottonStyle]
DynamicVariables = 1
Group = Active

[MeterNext]
Meter = Image
ImageName = #@#Next.png
X = (10*#Scale#)R
Y = ((#Height#*#Scale#)-(15*#Scale#))/2
W = (15*#Scale#)
H = (15*#Scale#)    
AntiAlias = 1
ImageTint = #Color#
LeftMouseDownAction = [!SetOption MeterNext ImageTint "#Highlight#"]
LeftMouseUpAction = [!SetOption MeterNext ImageTint "#*Color*#"][!CommandMeasure MeasurePlayPause "Next"]
MouseOverAction = [!ShowMeter BottonStyle][!SetOption BottonStyle X "([MeterNext:X]-(3*#Scale#))"][!SetOption BottonStyle Y "([MeterNext:Y]-(3*#Scale#))"]
MouseLeaveAction = [!SetOption MeterNext ImageTint "#*Color*#"][!HideMeter BottonStyle]
DynamicVariables = 1
Group = Active

[MeasureTime]
Measure = Time
Format = %I:%M %p

[MeasureDate]
Measure = Time
Format = %a, %b %#d

[ActionCenter]
Measure = Plugin
Plugin = SendKeys
Keys = LWin+A
Delay = 0

[NotificationCenter]
Measure = Plugin
Plugin = SendKeys
Keys = LWin+N
Delay = 0

[MeterNotificationCenter]
Meter = Image
ImageName = #@#Notification.png
X = (#ScreenAreaWidth#-(25*#Scale#))
Y = ((#Height#*#Scale#)-(15*#Scale#))/2
W = (15*#Scale#)
H = (15*#Scale#)
AntiAlias = 1
ImageTint = #Color#
LeftMouseDownAction = [!SetOption MeterNotificationCenter ImageTint "#Highlight#"]
LeftMouseUpAction = [!SetOption MeterNotificationCenter ImageTint "#*Color*#"][!CommandMeasure NotificationCenter "Send"]
MouseOverAction = [!ShowMeter BottonStyle][!SetOption BottonStyle X "([MeterNotificationCenter:X]-(2.7*#Scale#))"][!SetOption BottonStyle Y "([MeterNotificationCenter:Y]-(2.7*#Scale#))"]
MouseLeaveAction = [!SetOption MeterNotificationCenter ImageTint "#*Color*#"][!HideMeter BottonStyle]
DynamicVariables = 1

[MeterTimeXDate]
Meter = String
MeasureName  = MeasureTime
MeasureName2 = MeasureDate
Text = "%1  -  %2"
X = ([MeterNotificationCenter:X]-(15*#Scale#))
Y = ((#Height#*#Scale#)-(19.5*#Scale#))/2
FontColor = #Color#
FontSize = (10*#Scale#)
FontFace = Segoe UI
FontWeight = 500
AntiAlias = 1
ClipString = 1
StringAlign = RightTop
DynamicVariables = 1

[MeterActionCenter]
Meter = Image
ImageName = #@#ControlCenter.png
X = ([MeterTimeXDate:X]-(30*#Scale#))
Y = ((#Height#*#Scale#)-(15*#Scale#))/2
W = (15*#Scale#)
H = (15*#Scale#)
AntiAlias = 1
ImageTint = #Color#
LeftMouseDownAction = [!SetOption MeterActionCenter ImageTint "#Highlight#"]
LeftMouseUpAction = [!SetOption MeterActionCenter ImageTint "#*Color*#"][!CommandMeasure ActionCenter "Send"]
MouseOverAction = [!ShowMeter BottonStyle][!SetOption BottonStyle X "([MeterActionCenter:X]-(3*#Scale#))"][!SetOption BottonStyle Y "([MeterActionCenter:Y]-(3*#Scale#))"]
MouseLeaveAction = [!SetOption MeterActionCenter ImageTint "#*Color*#"][!HideMeter BottonStyle]
DynamicVariables = 1